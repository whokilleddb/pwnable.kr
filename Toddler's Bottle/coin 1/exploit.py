from pwn import *
from time import sleep

nc=remote("pwnable.kr",9007)
print((nc.recv(10024)).decode('UTF-8'))

#Sleep for 3 seconds and let the process initiate
sleep(3)

try :
    for i in range(100):
        #receive number of coins (N) and number of chances (C)
        conn=(nc.recv(1024)).decode('UTF-8')
        print(conn)
        n=int(conn.split(' ')[0].split('=')[1])
        c=int(conn.split(' ')[1].split('=')[1])
        #Good Ol' Binary Algorithm
        min=0
        max=n
        for j in range(c):
            payload=""
            for i in range(min, int((min+max)/2)):
                payload=payload+str(i)+" "
            print("[+] Server "+ payload)
            nc.sendline(payload)
            output = int(nc.recv(1024).decode('UTF-8').strip())
            print("[-] Client "+ str(output))
            if output%10 == 9:
                max=int((min+max)/2)
            elif min==max:
                break
            else  :
                min=int((min+max)/2)
        nc.sendline(str(min))
        print(nc.recv(1024).decode('UTF-8'))

    #Print Flag
    print(nc.recv(1024).decode('UTF-8'))
    nc.close()          

except ValueError :
    print("[-] Time Up") 

        

